<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Viewer с точным вращением и переключением</title>
    <style>
        body { margin:0; text-align:center; font-family: Arial; background: #f5f5f5; }
        #container { width: 100%; height: 500px; margin: 20px auto; }
        input, button { margin:5px; padding:5px 10px; font-size:14px; }
        select { margin:5px; padding:5px 10px; font-size:14px; }
    </style>
</head>
<body>
<h1>3D Viewer</h1>

<!-- Выбор модели из папки -->
<select id="modelSelect">
    <option value="models/scan1.glb">scan1</option>
    <option value="models/scan2.glb">scan2</option>
    <!-- Можно добавлять новые модели сюда -->
</select>
<button id="loadSelected">Загрузить выбранную модель</button>
<br>

<!-- Загрузка своей модели -->
<input type="file" id="fileInput" accept=".glb,.gltf">
<br>

<!-- Вращение по осям -->
<label>X (°): <input type="number" id="rotX" value="0"></label>
<label>Y (°): <input type="number" id="rotY" value="0"></label>
<label>Z (°): <input type="number" id="rotZ" value="0"></label>
<button id="applyRotation">Применить</button>

<div id="container"></div>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>

<script>
const container = document.getElementById('container');
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xf5f5f5);

const camera = new THREE.PerspectiveCamera(75, container.clientWidth/container.clientHeight, 0.1, 1000);
camera.position.set(0,1,3);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(container.clientWidth, container.clientHeight);
container.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

// Освещение
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,7.5);
scene.add(light);

// GLTF Loader
const loader = new THREE.GLTFLoader();
let model;

// Функция загрузки модели
function loadModel(url) {
    if(model) scene.remove(model);
    loader.load(url, gltf => {
        model = gltf.scene;
        model.rotation.set(0,0,0);
        scene.add(model);
    });
}

// Загрузка модели по умолчанию
loadModel('models/scan1.glb');

// Анимация
function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene,camera);
}
animate();

// Вращение по осям
document.getElementById('applyRotation').addEventListener('click', () => {
    if(model) {
        model.rotation.x = THREE.MathUtils.degToRad(document.getElementById('rotX').value);
        model.rotation.y = THREE.MathUtils.degToRad(document.getElementById('rotY').value);
        model.rotation.z = THREE.MathUtils.degToRad(document.getElementById('rotZ').value);
    }
});

// Загрузка собственной модели через input
document.getElementById('fileInput').addEventListener('change', (event) => {
    const file = event.target.files[0];
    if(!file) return;
    const url = URL.createObjectURL(file);
    loadModel(url);
});

// Переключение между моделями из select
document.getElementById('loadSelected').addEventListener('click', () => {
    const url = document.getElementById('modelSelect').value;
    loadModel(url);
});
</script>
</body>
</html>